## 1.6.1 싱글톤 레지스트리로서의 애플리케이션 컨텍스트
- 애플리케이션 컨텍스트는 싱글톤을 저장하고 관리하는 싱글톤 레지스트리다. 스프링은 기본적으로 내부에서 생성하는 빈 오브젝트를 싱글톤으로 만든다
- 싱글톤 패턴: 어떤 클래스를 애플리케이션 내에서 제한된 인스턴스 개수, 하나만 존재하도록 강제하는 패턴

- 싱글톤 패턴을 적용한 UserDao
```java
public class UserDao {
    private static UserDao INSTANCE;
    private ConnectionMaker connectionMaker;
    
    private UserDao(ConnectionMaker connectionMaker) {
        this.connectionMaker = connectionMaker;
    }
    
    public static synchronized UserDao getInstance() {
        if (INSTANCE == null) {
            INSTANCE = new UerDao(??);
        }
        return INSTANCE;
    }
    ...
}
```

#### 일반적인 싱글톤 패턴 문제점
1. private 생성자를 갖고 있기에 상속할 수 없다
	- 상속과 다형성을 적용할 수 없다
2. 싱글톤은 테스트하기가 힘들다
	- 만들어지는 방식이 제한적이기 때문에 테스트에서 사용될 때 목 오브젝트 등올 대체하기 어렵다
	- 필요한 오브젝트는 직접 만들어 사용할 수 밖에 없다
3. 서버환경에서는 싱글톤이 하나만 만들어지는 것을 보장하지 못한다
	- 클래스 로더를 어떻게 구성하고 있느냐에 따라서 싱글톤 클래스임에도 하나 이상의 오브젝트를 만들어질 수 있다
4. 싱글톤의 사용은 전역 상태를 만들 수 있기에 바람직하지 못하다.
	- 싱글톤의 static method로 인해 애플리케이션 어디든지 사용될 수 있다 -> 전역 상태로 사용되기 싶다

### 싱글톤 레지스트리
- 스프링은 직접 싱글톤 형태의 오브젝트를 만들고 관리하는 기능을 제공한다
- 평범한 자바 클래스를 싱글톤으로 활용하게 해준다. 평범한 자바 클래스라도 IoC 방식의 컨테이너를 사용해 생성과 관계설정, 사용 등에 대한 제어권을 컨테이너에게 넘겨 싱글톤 방식으로 관리한다
- public 생성자를 가질 수 있어 간단히 오브젝트를 생성해서 사용할 수 있다
- 테스트 환경에서 자유롭게 오브젝트를 만들 수 있다

## 1.6.2 싱글톤과 오브젝트의 상태
#### 싱글톤의 무상태성(stateless)
- 멀티스레드 환경에서 상태 정보를 갖지 않는 무상태를 유지해야 한다
	- 싱글톤은 멀티스레드 환경이면 여러 스레드가 동시에 접근해서 사용할 수 있다
	- 다중 사용자의 요청을 한꺼번에 처리하는 스레드들이 동시에 싱글톤 오브젝트의 인스턴스 변수를 수정하는 것은 매우 위험하다. 저장할 공간이 하나 뿐이니 서로 값을 덮어쓰고 자신이 저장하지 않은 값을 읽어올 수 있기 때문이다
	- 만약 상태가 읽기 전용으로 사용된다면 문제가 없다 -> static final이나 final로 선언하는 것이 낫다

## 1.6.3 스프링 빈의 스코프
- 스코프: 빈이 생성되고, 존재하고, 적용되는 범위
- 스프링에서 만들어지는 대부분의 빈은 싱글톤 스코프를 갖는다